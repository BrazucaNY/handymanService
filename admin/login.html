<div class="login-container">
  <div class="logo">SP</div>
  <h1>Admin Login</h1>
  <p class="subtitle">Authorized Access Only</p>

  <!-- Email login -->
  <input id="email" type="email" placeholder="Email"/>
  <input id="password" type="password" placeholder="Password"/>
  <button id="email-login-btn">Login with Email</button>

  <!-- GitHub login -->
  <button id="github-login-btn">Sign in with GitHub</button>

  <div id="error-message"></div>
</div>

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js';

const firebaseConfig = {
  apiKey: import.meta.env.VITE_FIREBASE_API_KEY,
  authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
  projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,
  storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
  appId: import.meta.env.VITE_FIREBASE_APP_ID,
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

function showError(msg){
  const div = document.getElementById('error-message');
  div.textContent = msg;
  div.style.display='block';
  setTimeout(()=> div.style.display='none',5000);
}

// Email login
document.getElementById('email-login-btn').addEventListener('click', async ()=>{
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  try{
    await signInWithEmailAndPassword(auth, email, password);
    window.location.href='/admin/dashboard.html';
  }catch(e){ showError(e.message); }
});

// Redirect if logged in
onAuthStateChanged(auth, user=>{
  if(user) window.location.href='/admin/dashboard.html';
});

// GitHub login: redirect to GitHub OAuth page
document.getElementById('github-login-btn').addEventListener('click', ()=>{
  const clientId = import.meta.env.VITE_GITHUB_CLIENT_ID;
  const redirectUri = window.location.origin; // or a backend redirect endpoint
  const githubUrl = `https://github.com/login/oauth/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&scope=user:email`;
  window.location.href = githubUrl;
});
</script>
